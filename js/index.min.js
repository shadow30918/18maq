function CityStoreListByEvent(){$.ajax({url:"func.php",type:"POST",data:{func:"CityStoreListByEvent"},dataType:"json"}).done(function(t){if(1==t.OK){for(var e=0;e<t.cityRows.length;e++)$("#city").append('<option value="'+t.cityRows[e].c_no+'">'+t.cityRows[e].c_name+"</option>");for(var i=0;i<t.storeRows.length;i++)$("#shop").append('<option value="'+t.storeRows[i].s_no+'" class="'+t.storeRows[i].c_no+'" text="'+t.storeRows[i].s_name.replace(/br/gi,"<br />")+'">'+t.storeRows[i].s_name.replace(/br/gi,"")+"</option>");$("div.form .form_btn").click(function(){checkData()}),$("#shop").chained("#city")}$("div.top div.count > span").empty().append(formatCurrency(t.total))})}function checkData(){if($("div.form .form_btn").hasClass("disabled"))alert("您的資料己送出, 請勿重覆點擊, 造成資料重覆!");else{var t=1,e="";t_name=$.trim($("#name").val()),t_mobile=$.trim($("#phone").val()),t_email=$.trim($("#email").val()),c_no=$.trim($("#city").val()),s_no=$.trim($("#shop").val()),0==t_name.length?(e=checkAlertMsg(e),e+="- 姓名",t=0):ValidateName(t_name)||(t_name.length<2&&(e=checkAlertMsg(e),e+="- 姓名長度不符合",t=0),isNaN(t_name)||(e=checkAlertMsg(e),e+="- 姓名不可含數字",t=0));var i=t_mobile.substr(0,2),n=/^[0-9]{2,3}\-[0-9]{5,8}$/,s=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,4})+$/;if(0==t_mobile.length?(e=checkAlertMsg(e),e+="- 手機",t=0):("09"!=i||10!=t_mobile.length||n.test(t_mobile))&&(e=checkAlertMsg(e),e+="- 手機號碼有誤",t=0),0==t_email.length?(e=checkAlertMsg(e),e+="- 電子郵件",t=0):(t_email.length<=2||!s.test(t_email))&&(e=checkAlertMsg(e),e+="- 電子郵件有誤",t=0),""!=c_no&&""!=s_no||(e=checkAlertMsg(e),e+="- 領取櫃點",t=0),$(".agree input").is(":checked")||(e=checkAlertMsg(e),e+="- 請同意條款與注意事項",t=0),1!=t)return alert("請確認以下欄位:\r\n\r\n"+e+"\r\n\r\n"),!1;$("div.form .form_btn").addClass("disabled"),SubmitForm()}}function SubmitForm(){$.ajax({url:"func.php",type:"POST",data:{func:"SubmitForm",c_no:c_no,s_no:s_no,t_name:t_name,t_mobile:t_mobile,t_email:t_email},dataType:"json"}).done(function(t){var e=parseInt(t.OK,10);0==e&&(1==t.status&&alert("您的資料中有欄位未填, 請檢查您所填寫的資料!"),2==t.status&&alert("您的資料中有欄位格式不符, 請檢查您所填寫的資料!"),3==t.status&&alert("您的資料中所選擇的櫃點與所在縣市不符, 請檢查您所填寫的資料!"),4==t.status&&alert("您的資料中所選擇的櫃點領取名額己額滿, 請選擇其他領取櫃點!"),5==t.status&&alert("您的手機己參加兌換活動, 且仍在可兌換贈品的時間內, 所以無法重複申請!"),6==t.status&&alert("您己完成己兌換, 所以無法重複申請!"),7==t.status&&alert("您己完成己兌換, 所以無法重複申請!"),8==t.status&&alert("您的Email己參加兌換活動, 且仍在可兌換贈品的時間內, 所以無法重複申請!"),9==t.status&&alert("不明錯誤發生, 請重整網頁重新申請!")),1==e&&(t_no=t.t_no,t_sn_no=t.t_sn_no,token=t.token,window.location="https://www.shiseido-event.com/2018maquillage/thank.html?c_no="+c_no+"&s_no="+s_no+"&t_no="+t_no+"&t_sn_no="+t_sn_no+"&token="+token)})}function updateRWDImg(){$("img").each(function(t){var e=$(this).attr("src").replace("-dt.",".").split(".");1==$(this).attr("md")&&($(this).attr("src",e[0]+"-dt."+e[1]),isMobile?$(this).attr("src",e[0]+"."+e[1]):$(this).attr("src",e[0]+"-dt."+e[1])),0==$(this).attr("md")&&(isMobile?$(this).hide():$(this).show())})}function getSize(){windowWidth=$(window).width(),windowHeight=$(window).height(),documentHeight=$(document).height(),isMobile=windowWidth<800,isMobile?$(".menu .inner").hide():$(".menu .inner").show()}function formatCurrency(t){return toNumber(t).toLocaleString("en")}function toNumber(t){return+t}function checkAlertMsg(t){return t.length>0&&(t+="\r\n"),t}function ValidateName(t){return!!/^[\u4e00-\u9fa5a-zA-Z]{2,20}$/.test(t)}$(function(){CityStoreListByEvent()}),$(document).ready(function(){AOS.init({duration:500,easing:"ease-in"}),getSize(),updateRWDImg();var t=$(window).height(),e=$(".guilty .title").offset().top-t/3*1;$(window).scroll(function(){var t=$(window).scrollTop();t>100?$(".menu").addClass("scroll"):$(".menu").removeClass("scroll"),t>e&&($(".g1 .s1").addClass("active"),$(".g1 .s2").fadeIn(500),$(".g2 .s1").delay(500).addClass("active"),$(".g2 .s2").delay(500).fadeIn(500),$(".g3 .s1").delay(1e3).addClass("active"),$(".g3 .s2").delay(1e3).fadeIn(500))}),$(window).on("resize",function(){getSize(),updateRWDImg()}),$(".guilty_slider").slick({arrows:!0,dots:!1,infinite:!0,nextArrow:'<i class="icon-right-open-big next"></i>',prevArrow:'<i class="icon-left-open-big prev"></i>'}),$(".guilty_s2_slider").slick({arrows:!0,dots:!1,infinite:!0,nextArrow:'<i class="icon-right-open-big next"></i>',prevArrow:'<i class="icon-left-open-big prev"></i>'}),$(".btn").click(function(){$(".guilty_slider").addClass("active"),$(".guilty_s2_slider").addClass("active"),$(".s2_close").addClass("active")}),$(".s2_close").click(function(){$(".guilty_slider").removeClass("active"),$(".guilty_s2_slider").removeClass("active"),$(".s2_close").removeClass("active")}),$(".g_btn").mouseover(function(){n=$(this).attr("data"),$(".show img").attr("src","img/guilty_dt_s3-"+n+".png"),$(".show").addClass("active")}),$(".ham").click(function(){$(".menu .inner").slideDown(500)}),$(".menu_close").click(function(){$(".menu .inner").slideUp(500)}),$(".menu .inner li").click(function(){toNav=$(this).attr("data"),isMobile?($(".menu .inner").slideUp(500),$("html,body").animate({scrollTop:$("."+toNav).offset().top},1e3,"swing")):$("html,body").animate({scrollTop:$("."+toNav).offset().top-80},1e3,"swing")}),$(".show").mouseout(function(){$(this).removeClass("active"),$(".show img").attr("src","")}),$(".pre,.next").click(function(){n=$(this).attr("data"),$(this).parents(".group").removeClass("active"),$('.group[data="'+n+'"]').addClass("active")})});